/* 12:10:47 14/03/2014 [http://oystatic.ignimgs.com/src/core/js/widgets/social/shared/followbutton.js]*/
jQuery.namespace=function(){var a=arguments,b=null,c,e,d;for(c=0;c<a.length;c+=1){d=a[c].split(".");b=window;for(e=0;e<d.length;e+=1)b[d[e]]=b[d[e]]||{},b=b[d[e]]}return b};jQuery.namespace("ign.social");
ign.social.generic={error:function(a){"undefined"!==typeof console&&null!=console&&console.log(a)},nicetime:function(a){var b="milliseconds,second,minute,hour,day,week,month,year,decade".split(","),c="1000,60,60,24,7,4.35,12,10".split(","),a=new Date-new Date(a);for(j=0;a>=c[j]&&j<c.length-1;j++)a/=c[j];a=Math.round(a);1!=a&&(b[j]+="s");return a+" "+b[j]+" ago"}};
jQuery(document).ready(function(){jQuery(".statusBttnContainer .statusBttn").live("click",function(){_gaq.push(["_trackEvent","Post","Status","from header"])});jQuery(".myIgnSignInText a").live("click",function(a){a.preventDefault();a="http://widgets.ign.com/social/shared/registration/"+jQuery(this).attr("js-data")+".jsonp?disable_js=false&r="+encodeURIComponent(window.location.href);jQuery.ajax({url:a,jsonpCallback:"regModal",dataType:"jsonp",success:function(a){jQuery("body").append(a)}})});ign.social.addtomyign=
{persistentKey:"IGNFollowValues",IGNpersistentValue:"",IGNpersistentValueArray:[],userState:"unknown",getCookie:function(a){for(var a=a+"=",b=a.length,c=document.cookie.length,e=0;e<c;){var d=e+b;if(document.cookie.substring(e,d)==a)return ign.social.addtomyign.getCookieVal(d);e=document.cookie.indexOf(" ",e)+1;if(0==e)break}return null},getCookieVal:function(a){var b=document.cookie.indexOf(";",a);if(-1==b)b=document.cookie.length;return unescape(document.cookie.substring(a,b))},expires:18144E5,
persistentLoad:function(a){return ign.social.addtomyign.getCookie(a)},persistentSave:function(a,b){today=new Date;var c=new Date(today.getTime()+ign.social.addtomyign.expires);document.cookie=a+"="+escape(b)+"; expires="+c.toGMTString()+"; path=/; domain=ign.com;"},persistentRemove:function(a){if(ign.social.addtomyign.getCookie(a)){today=new Date;var b=new Date(today.getTime()-ign.social.addtomyign.expires);document.cookie=a+"=; expires="+b.toGMTString()+"; path=/; domain=ign.com;"}},buttonHTML:'<div class="addToIGNContainer"><div class="addToIGN"></div><div class="addToIGNControls"><ul></ul></div></div>',
currentButtonState:"unknown",getCookieData:function(a){var b=a.length,c=document.cookie;if(c){var e=document.cookie.length;if(0<e&&(a=c.indexOf(a+"="),-1<a)){var d=c.indexOf(";",a);return unescape(c.substring(a+b+1,-1==d?e:d))}}return""},myIgnAlphaAccess:function(){return 1==ign.social.addtomyign.getCookieData("MyIGNAlpha")?!0:!1},getUserID:function(){var a=void 0;if(1<=jQuery("#user-tools .tools").length||1<=jQuery("#ign-header .user-info").length){var b=1<=jQuery("#ign-header .user-info").length?
jQuery("#ign-header .user-info").attr("js-data"):jQuery("#user-tools .tools").attr("js-data");if(""!==b)b=jQuery.parseJSON(b),a=b.nickname}return a},post_method:function(a,b){jQuery("#proxy_frame");var c=document.createElement("IFRAME");c.id="proxy_frame";c.style.display="none";jQuery("body").append(c);c=c.contentWindow.document;c.open();c.write('<form method="POST" action="'+a+'">');c.write("<input type='text' name='data' value='");c.write(b.data);c.write("' />");c.write("</form>");c.write("<script>window.onload = function(){document.forms[0].submit(); }<\/script>");
c.close()},fireEvent:function(a,b,c){igndrones.async.push(function(){igndrones.fireEvent("Community:"+a+" Follow","User:"+b,c)})},init:function(){ignSocialNickname=ign.social.addtomyign.getUserID();if(void 0!==ignSocialNickname)ign.social.addtomyign.userState="known";null==ign.social.addtomyign.persistentLoad(ign.social.addtomyign.persistentKey)?ign.social.addtomyign.IGNpersistentValue="":ign.social.addtomyign.IGNpersistentValueArray=ign.social.addtomyign.persistentLoad(ign.social.addtomyign.persistentKey).toString().split(",");
mediaItemObj=function(){};mediaItemObj.prototype.id=0;mediaItemObj.prototype.showInNewsFeed="true";if(void 0!==ignSocialNickname&&-1<document.domain.toString().indexOf("my.ign.com")){for(i=0;i<ign.social.addtomyign.IGNpersistentValueArray.length;i++){mediaItem=new mediaItemObj;if(-1<ign.social.addtomyign.IGNpersistentValueArray[i].toString().indexOf("Person"))mediaItem.id=ign.social.addtomyign.IGNpersistentValueArray[i].toString().replace(/Person/g,""),mediaItem.preferences=["show_in_newsfeed"],dataString=
JSON.stringify(mediaItem),jQuery.post("/proxy?method=POST&dest=http://apis.ign.com/v1.0/social/rest/people/nickname."+ignSocialNickname+"/@friends",{data:dataString});if(-1<ign.social.addtomyign.IGNpersistentValueArray[i].toString().indexOf("Game"))mediaItem.id=ign.social.addtomyign.IGNpersistentValueArray[i].toString().replace(/Game/g,""),mediaItem.showInNewsFeed="true",dataString=JSON.stringify(mediaItem),jQuery.post("/proxy?method=POST&dest=http://apis.ign.com/v1.0/social/rest/mediaItems/nickname."+
ignSocialNickname+"/@self/@collection",{data:dataString})}ign.social.addtomyign.persistentRemove(ign.social.addtomyign.persistentKey)}jQuery("div.myIgnFollowInstance").html(ign.social.addtomyign.buttonHTML);targetElementCount=jQuery("div.myIgnFollowInstance").size();gameIdsArray=[];personIdsArray=[];targetCounter=0;jQuery("div.myIgnFollowInstance").each(function(){ign.social.addtomyign.currentButtonState="undefined";if("undefined"!==jQuery(this).attr("state"))ign.social.addtomyign.currentButtonState=
jQuery(this).attr("state");if("unknown"==ign.social.addtomyign.userState){-1<jQuery(this).attr("id").indexOf("Person")&&(newPersistentValue="person"+jQuery(this).attr("id").replace(/myIgnFollowPerson/g,""));-1<jQuery(this).attr("id").indexOf("myIgnFollowGame")&&(newPersistentValue="game"+jQuery(this).attr("id").replace(/myIgnFollowGame/g,""));if(""!=ign.social.addtomyign.IGNpersistentValue)for(i=0;i<ign.social.addtomyign.IGNpersistentValueArray.length;i++)if(ign.social.addtomyign.IGNpersistentValueArray[i]==
newPersistentValue)ign.social.addtomyign.currentButtonState="known";"known"==ign.social.addtomyign.currentButtonState?(jQuery(this).children().children().filter(".addToIGN").css("background","url(http://media.ign.com/ign/stp/img/add-to-my-ign_button/following_btn.png) no-repeat"),jQuery(this).children().children().filter(".addToIGN").css("width","125px")):(jQuery(this).children().children().filter(".addToIGN").css("background","url(http://media.ign.com/ign/stp/img/add-to-my-ign_button/follow_btn.png) no-repeat"),
jQuery(this).children().children().filter(".addToIGN").css("width","88px"));jQuery(this).attr("state",ign.social.addtomyign.currentButtonState)}else{var a=function(a){return function(c){jQuery.each(c.entry,function(c,d){"people"==a&&(targetObject=document.getElementById("myIgnFollowPersonnickname."+d.nickname),null==targetObject&&(targetObject=document.getElementById("myIgnFollowPerson."+d.nickname)),null==targetObject&&(targetObject=document.getElementById("myIgnFollowPerson"+personIdsArray[c])),
d.relationship.amIFollowingThisPerson?(jQuery(targetObject).children().children().filter(".addToIGN").css("background","url(http://media.ign.com/ign/stp/img/add-to-my-ign_button/following_btn.png) no-repeat"),jQuery(targetObject).children().children().filter(".addToIGN").css("width","125px"),jQuery(targetObject).attr("state","known")):(jQuery(targetObject).children().children().filter(".addToIGN").css("background","url(http://media.ign.com/ign/stp/img/add-to-my-ign_button/follow_btn.png) no-repeat"),
jQuery(targetObject).children().children().filter(".addToIGN").css("width","88px"),jQuery(targetObject).attr("state","unknown")));"games"==a&&(targetObject=document.getElementById("myIgnFollowGamegobid."+d.foreignId),null==targetObject&&(targetObject=document.getElementById("myIgnFollowGamegobid.0"+d.foreignId)),d.relationship.amIFollowingThis?(jQuery(targetObject).children().children().filter(".addToIGN").css("background","url(http://media.ign.com/ign/stp/img/add-to-my-ign_button/following_btn.png) no-repeat"),
jQuery(targetObject).children().children().filter(".addToIGN").css("width","125px"),jQuery(targetObject).attr("state","known")):(jQuery(targetObject).children().children().filter(".addToIGN").css("background","url(http://media.ign.com/ign/stp/img/add-to-my-ign_button/follow_btn.png) no-repeat"),jQuery(targetObject).children().children().filter(".addToIGN").css("width","88px"),jQuery(targetObject).attr("state","unknown")))})}};void 0===ign.social.addtomyign.currentButtonState?(-1<jQuery(this).attr("id").indexOf("myIgnFollowPerson")&&
personIdsArray.push(jQuery(this).attr("id").replace(/myIgnFollowPerson/g,"")),-1<jQuery(this).attr("id").indexOf("myIgnFollowGame")&&gameIdsArray.push(jQuery(this).attr("id").replace(/myIgnFollowGame/g,"").toString())):"known"==ign.social.addtomyign.currentButtonState?(jQuery(this).children().children().filter(".addToIGN").css("background","url(http://media.ign.com/ign/stp/img/add-to-my-ign_button/following_btn.png) no-repeat"),jQuery(this).children().children().filter(".addToIGN").css("width","125px"),
jQuery(this).attr("state","known")):(jQuery(this).children().children().filter(".addToIGN").css("background","url(http://media.ign.com/ign/stp/img/add-to-my-ign_button/follow_btn.png) no-repeat"),jQuery(this).children().children().filter(".addToIGN").css("width","88px"),jQuery(this).attr("state","unknown"))}targetCounter++;targetCounter==targetElementCount&&(0<personIdsArray.length&&""!=personIdsArray[0]&&jQuery.getJSON("http://apis.ign.com/v1.0/social/rest/people/nickname."+ignSocialNickname+"/@all/"+
personIdsArray.toString()+"?jsonp=?",a("people")),0<gameIdsArray.length&&""!=gameIdsArray[0]&&jQuery.getJSON("http://apis.ign.com/v1.0/social/rest/mediaItems/nickname."+ignSocialNickname+"/@all/@all/"+gameIdsArray.toString()+"?jsonp=?",a("games")));jQuery(".myIGNCloseX").live("click",function(){jQuery(".followUpsellOverlay").css("display","none")});jQuery(this).bind("click",function(a){mediaItem=new mediaItemObj;if(-1<jQuery(this).attr("id").indexOf("myIgnFollowGame"))mediaItem.id=this.id.replace(/myIgnFollowGame/g,
""),mediaItem.showInNewsFeed="true";if(-1<jQuery(this).attr("id").indexOf("Person"))mediaItem.id=this.id.replace(/myIgnFollowPerson/g,""),mediaItem.preferences=["show_in_newsfeed"];a.preventDefault();a="";if("unknown"==jQuery(this).attr("state")||void 0==jQuery(this).attr("state"))if("unknown"==ign.social.addtomyign.userState)jQuery(this).attr("id").indexOf("Person")&&(thisPersistentValue="Person"+jQuery(this).attr("id").replace(/myIgnFollowPerson/g,""),a="person"),-1<jQuery(this).attr("id").indexOf("myIgnFollowGame")&&
(thisPersistentValue="Game"+jQuery(this).attr("id").replace(/myIgnFollowGame/g,""),a="game"),htmlChunk="<style type='text/css'>.followUpsellOverlay {padding:0px;position:absolute;top:0;left:0;width:303px;background-color: #FFFFFF;border-right: 1px solid #D32028;border-left: 1px solid #D32028;}",htmlChunk+=".myIGNCloseX { height: 26px;left: 292px;position: absolute;top: -12px;width: 23px;background:url('http://oystatic.ignimgs.com/src/social/img/icons_sprite.png') no-repeat scroll 0 -4635px transparent;}",
htmlChunk+=".myIgnGetStarted {background:url('http://oystatic.ignimgs.com/src/social/img/follow-btn/Get-started-btn.png') no-repeat scroll 0 0 transparent;width:150px;height:40px;overflow:hidden;display:inline;margin: 0 12px 12px 8px;float:left;}",htmlChunk+=".myIgnGetStarted:hover {background:url('http://oystatic.ignimgs.com/src/social/img/follow-btn/Get-started-btn.png') no-repeat scroll 0 -45px transparent;}",htmlChunk+=".addToIGNContainer .followUpsellOverlay .myIgnSignInText {margin: 12px 0 0;float:left;font-size:14px;} .upsellGraphic {margin:10px 0 10px 8px;}",
htmlChunk+=".bottomRedBarOvrly {background-color:#D32028;height:4px;clear:both;}.followOvrlyInside {padding:4px;}.greyMeOvrly{display:block;float:right;width:230px;height:4px;background-color:#cccccc;}</style>",htmlChunk+="<script type='text/javascript'>jQuery(\".myIgnGetStarted\").live('click',function() {jQuery(\".myIgnGetStarted\").css('background','url(http://oystatic.ignimgs.com/src/social/img/follow-btn/Get-started-btn.png) no-repeat scroll 0 -90px transparent'); window.location = 'http://my.ign.com/register?utm_source=followButton&utm_medium=button&utm_content=loggedOutState&utm_campaign=socialFollowButton&r="+
window.location.href+"'; });<\/script>",htmlChunk+='<div class="followUpsellOverlay"><div class="myIGNCloseX"></div><div class="bottomRedBarOvrly"><span class="greyMeOvrly"></span></div>',htmlChunk+='<img src="http://oystatic.ignimgs.com/src/social/img/follow-btn/my-ign-editors.png" border="0" />',htmlChunk="person"==a?htmlChunk+'<img class="upsellGraphic" src="http://oystatic.ignimgs.com/src/social/img/follow-btn/value-props-people.jpg" border="0" />':htmlChunk+'<img class="upsellGraphic" src="http://oystatic.ignimgs.com/src/social/img/follow-btn/value-prop-games.jpg" border="0" />',
htmlChunk+='<div class="myIgnGetStarted"></div><span class="myIgnSignInText ignHeader-authentication">or  <a href="http://s.ign.com/signin" js-data="signin" class="authReturnUrl">Sign in</a></span>',htmlChunk+='<div class="bottomRedBarOvrly"></div></div>',jQuery(this).children().filter(".addToIGNContainer").append(htmlChunk),jQuery(this).children().filter(".addToIGNContainer").css("position","relative");else{if(-1<jQuery(this).attr("id").indexOf("Person"))myPostArray=Array(mediaItem),dataString=JSON.stringify(myPostArray),
ign.social.addtomyign.post_method("http://my.ign.com/proxy?method=POST&dest=http://apis.ign.com/v1.0/social/rest/people/nickname."+ignSocialNickname+"/@friends",{data:dataString}),this.state="known",ign.social.addtomyign.fireEvent("User",jQuery(this).attr("data-follower-id"),jQuery(this).attr("data-followee-id"));if(-1<jQuery(this).attr("id").indexOf("myIgnFollowGame"))dataString=JSON.stringify(mediaItem),ign.social.addtomyign.post_method("http://my.ign.com/proxy?method=POST&dest=http://apis.ign.com/v1.0/social/rest/mediaItems/nickname."+
ignSocialNickname+"/@self/@collection",{data:dataString}),this.state="known",ign.social.addtomyign.fireEvent("Game",jQuery(this).attr("data-follower-id"),jQuery(this).attr("data-game-id"));jQuery(this).children().children().filter(".addToIGN").css("background","url(http://media.ign.com/ign/stp/img/add-to-my-ign_button/following_btn.png) no-repeat");jQuery(this).children().children().filter(".addToIGN").css("width","125px");jQuery(this).children().children().filter(".addToIGNControls").children().children().remove();
htmlChunk=-1<jQuery(this).attr("id").indexOf("myIgnFollowGame")?'<div class="manageStuff"><a href="http://my.ign.com/games">Manage My Games</a></div>':'<div class="manageStuff"><a href="http://my.ign.com/people">Manage My People</a></div>';htmlChunk+='<div class="removeFromIGN">Remove</div>';jQuery(this).children().children().filter(".addToIGNControls").children().append(htmlChunk);jQuery(".removeFromIGN").bind("click.ignEvents",ign.social.addtomyign.removeFromIGN);jQuery(".myIgnFollowWishlist").bind("click.ignEvents",
ign.social.addtomyign.followWishlist);jQuery(".myIgnFollowCollection").bind("click.ignEvents",ign.social.addtomyign.followCollection);jQuery(".manageStuff").bind("click.ignEvents",ign.social.addtomyign.manageGames);jQuery(this).attr("state","known");jQuery(this).children().children().filter(".addToIGNControls").css("display","block")}else"known"==jQuery(this).attr("state")&&(0==jQuery(this).children().children().filter(".addToIGNControls").children().children().size()&&(htmlChunk=-1<jQuery(this).attr("id").indexOf("myIgnFollowGame")?
'<div class="manageStuff"><a href="http://my.ign.com/games">Manage My Games</a></div>':'<div class="manageStuff"><a href="http://my.ign.com/people">Manage My People</a></div>',htmlChunk+='<div class="removeFromIGN">Remove</div>',jQuery(this).children().children().filter(".addToIGNControls").children().append(htmlChunk),jQuery(".removeFromIGN").bind("click.ignEvents",ign.social.addtomyign.removeFromIGN),jQuery(".myIgnFollowWishlist").bind("click.ignEvents",ign.social.addtomyign.followWishlist),jQuery(".myIgnFollowCollection").bind("click.ignEvents",
ign.social.addtomyign.followCollection),jQuery(".manageStuff").bind("click.ignEvents",ign.social.addtomyign.manageGames)),jQuery(this).children().children().filter(".addToIGNControls").css("display","block"));jQuery.support.hrefNormalized||ign.social.addtomyign.resetZindex(jQuery(this).children().children().filter(".addToIGNControls"));jQuery(this).children().filter(".addToIGNContainer").unbind("mouseenter mouseleave");"known"==jQuery(this).attr("state")&&jQuery(this).children().filter(".addToIGNContainer").hover(function(){},
function(){jQuery(this).find(".addToIGNControls").is(":visible")&&(jQuery(this).find(".addToIGNControls").animate({height:"toggle"},"slow"),ign.social.addtomyign.revertZindex(jQuery(this).find(".addToIGNControls")))})})})},followWishlist:function(a){a.preventDefault();a.stopPropagation();targetId=jQuery(this).parent().parent().parent().parent().parent().attr("id");jQuery("#"+targetId+" div.myIgnFollowWishlist").addClass("myIgnFollowRadioCheck");jQuery("#"+targetId+" div.myIgnFollowCollection").removeClass("myIgnFollowRadioCheck");
mediaItem=new mediaItemObj;mediaItem.id=targetId.replace(/myIgnFollowGame/g,"");mediaItem.showInNewsFeed="true";dataString=JSON.stringify(mediaItem);ign.social.addtomyign.post_method("http://my.ign.com/proxy?method=POST&dest=http://apis.ign.com/v1.0/social/rest/mediaItems/nickname."+ignSocialNickname+"/@self/@wishlist",{data:dataString})},followCollection:function(a){a.preventDefault();a.stopPropagation();targetId=jQuery(this).parent().parent().parent().parent().parent().attr("id");jQuery("#"+targetId+
" .myIgnFollowWishlist").removeClass("myIgnFollowRadioCheck");jQuery("#"+targetId+" .myIgnFollowCollection").addClass("myIgnFollowRadioCheck");mediaItem=new mediaItemObj;mediaItem.id=targetId.replace(/myIgnFollowGame/g,"");mediaItem.showInNewsFeed="true";dataString=JSON.stringify(mediaItem);ign.social.addtomyign.post_method("http://my.ign.com/proxy?method=POST&dest=http://apis.ign.com/v1.0/social/rest/mediaItems/nickname."+ignSocialNickname+"/@self/@wishlist",{data:dataString})},manageGames:function(a){a.preventDefault();
a.stopPropagation();document.location=a.target},removeFromIGN:function(a){a.preventDefault();a.stopPropagation();targetRemoveId=jQuery(this).parent().parent().parent().parent().attr("id");-1<targetRemoveId.indexOf("myIgnFollowGame")&&(targetRemoveId=targetRemoveId.replace(/myIgnFollowGame/g,""));-1<targetRemoveId.indexOf("Person")&&(targetRemoveId=targetRemoveId.replace(/myIgnFollowPerson/g,""));targetType=-1<jQuery(this).parent().parent().parent().parent().attr("id").indexOf("Person")?"person":"game";
if("unknown"==ign.social.addtomyign.userState){"person"==targetType&&(newPersistentValue="person"+jQuery(this).attr("id"));"game"==targetType&&(newPersistentValue="game"+jQuery(this).attr("id"));ign.social.addtomyign.persistentLoad(ign.social.addtomyign.persistentKey);void 0==ign.social.addtomyign.IGNpersistentValue?(ign.social.addtomyign.IGNpersistentValue="",ign.social.addtomyign.IGNpersistentValueArray=[]):(ign.social.addtomyign.IGNpersistentValueArray=[],ign.social.addtomyign.IGNpersistentValueArray=
ign.social.addtomyign.IGNpersistentValue.split(","));for(i=0;i<ign.social.addtomyign.IGNpersistentValueArray.length;i++)ign.social.addtomyign.IGNpersistentValueArray[i]==thisPersistentValue&&ign.social.addtomyign.IGNpersistentValueArray.splice(i,1);ign.social.addtomyign.IGNpersistentValue=ign.social.addtomyign.IGNpersistentValueArray.toString();ign.social.addtomyign.persistentSave(ign.social.addtomyign.persistentKey,ign.social.addtomyign.IGNpersistentValue);ign.social.addtomyign.persistentLoad(ign.social.addtomyign.persistentKey)}else"person"==
targetType&&(justTargetRemoveId=targetRemoveId.toString().replace("myIgnFollowPerson",""),ign.social.addtomyign.post_method("http://my.ign.com/proxy?method=DELETE&dest=http://apis.ign.com/v1.0/social/rest/people/nickname."+ignSocialNickname+"/@friends/"+justTargetRemoveId,"")),"game"==targetType&&(justTargetRemoveId=targetRemoveId.toString().replace("myIgnFollowGame",""),ign.social.addtomyign.post_method("http://my.ign.com/proxy?method=DELETE&dest=http://apis.ign.com/v1.0/social/rest/mediaItems/nickname."+
ignSocialNickname+"/@self/"+justTargetRemoveId,""));jQuery(this).parent().parent().parent().children().filter(".addToIGN").css("background","url(http://media.ign.com/ign/stp/img/add-to-my-ign_button/follow_btn.png) no-repeat");jQuery(this).parent().parent().parent().children().filter(".addToIGN").css("width","88px");jQuery(this).parent().parent().parent().parent().attr("state","unknown");jQuery(this).parent().parent().css("display","none");jQuery(this+":parent:parent:parent:parent:parent > .addToIGNContainer").unbind("mouseenter mouseleave")},
resetZindex:function(a){for(var a=a.parents(),b=0;b<a.length;b++)pos=jQuery(a[b]).css("position"),("relative"==pos||"absolute"==pos||"fixed"==pos)&&jQuery(a[b]).addClass("on-top")},revertZindex:function(a){for(var a=a.parents(),b=0;b<a.length;b++)pos=jQuery(a[b]).css("position"),("relative"==pos||"absolute"==pos||"fixed"==pos)&&jQuery(a[b]).removeClass("on-top")}};ign.social.addtomyign.init()});
