window.ZIFFDAVISBIN=window.ZIFFDAVISBIN||{},window.ZIFFDAVISBIN.domain=window.ZIFFDAVISBIN.domain||function(){return window.location.hostname},function(){function parseQuerystring(url){var querystring={};return url?(url.replace(/([^?=&]+)(=([^&]*))?/g,function($0,$1,$2,$3){querystring[$1]=$3}),querystring):{}}function injectScript(opts){if(!opts.url)return void console.log("Can't load script; no script URL!");var loaded=0,urls=opts.url.length;opts.url.forEach(function(src){var script=document.createElement("script"),node=opts.to;script.src=src,script.onload=script.onreadystatechange=function(){(!script.readyState||/loaded|complete/.test(script.readyState))&&(script.onload=script.onreadystatechange=null,script=void 0,loaded++,loaded===urls&&"function"==typeof opts.callback&&opts.callback())},node&&node.insertBefore?node.insertBefore(script,node.firstChild):console.log("node not found or has no insertBefore method! Can't load script from: '"+opts.url+"'")})}function getFunctionByName(name,context){if(!name||!context)return null;for(var namespaces=name.split("."),func=namespaces.pop(),i=0;i<namespaces.length;i++)if(context=context[namespaces[i]],"undefined"==typeof context)return null;return context[func]}function getRelevantParameters(options){var relevantParameters={},irrelevantParameterNames=["onload"];for(var o in options)""!==options[o]&&irrelevantParameterNames.indexOf(o)<0&&(relevantParameters[o]=options[o]);return"referrer"in relevantParameters||(relevantParameters.referrer=window.ZIFFDAVISBIN.domain()),relevantParameters}function hashCode(s){var hash=0;if(0===s.length)return hash;for(var i=0;i<s.length;i++){var c=s.charCodeAt(i);hash=(hash<<5)-hash+c,hash&=hash}return hash}function generateCallback(parameters){var parametersArray=[];for(var i in parameters)parametersArray.push(i+"="+parameters[i]);parametersArray.push("i="+scriptIndex);var parameterMashup=parametersArray.join(";"),callback="buyitnow__"+Math.abs(hashCode(parameterMashup));return window[callback]=function(data){return data},callback}function getPrices(options){var parameters=getRelevantParameters(options),url=cseUrl;"true"===options.test&&(url="qa."+url),"true"===options.local&&(url="localhost:62262/CSE/TopPrices");var callback=generateCallback(parameters);return $.ajax({url:protocol+url,data:parameters,jsonpCallback:callback,dataType:"jsonp",cache:!0})}function getCountryCode(){var validCountries=["US","UK","AU","CA","PR"];if("undefined"!=typeof window.ZDXI){var co=window.ZDXI.Country();return validCountries.indexOf(co)>-1?co:"intl"}return"US"}function triggerCallback(callbackName,rows){if(callbackName){var callbackFn=getFunctionByName(callbackName,window);"function"==typeof callbackFn&&callbackFn(rows)}}function getFirstResult(data){for(var provider in data)for(var id in data[provider])return data[provider][id]}function configuration(offer){return""!==offer.Configuration?'<div class="pcmag-buyitnow-configuration">'+offer.Configuration+"</div>":""}function freeShipping(offer){return"Free"===offer.Shipping?"<div class='pcmag-buyitnow-shipping'>+Free Shipping</div>":""}function track(offer){var vendor=offer.CanonicalVendor?offer.CanonicalVendor:offer.Vendor,signal="http://zdbb.net/l/NDgzOWJiYWMtMDJhMy0xMQ?guid="+encodeURIComponent(offer.Guid)+"&provider="+encodeURIComponent(offer.Provider.toLowerCase())+"&productId="+encodeURIComponent(offer.ProviderProductId)+"&price="+encodeURIComponent(offer.Price)+"&merchant="+encodeURIComponent(vendor.toLowerCase())+"&ziffcatId="+encodeURIComponent(offer.ZiffcatId)+"&module="+encodeURIComponent("buyitnow")+"&buster="+Math.floor(1e10*Math.random()),bbImg=$("<img width='1' height='1' border='0'>").attr("src",signal);$("body").append(bbImg)}function htmlEncode(str){return str.replace("'","&apos;").replace('"',"&quot;").replace("<","&lt;").replace(">","&gt;")}function trackingAttributesFor(offer){var trackingAttributes=[];for(var attr in offer)"url"!==attr.toLowerCase()&&"openhtml"!==attr.toLowerCase()&&"string"==typeof offer[attr]&&trackingAttributes.push("data-commerce-"+attr+'="'+htmlEncode(offer[attr])+'"');return trackingAttributes.join(" ")}function header(hed){return hed=decodeURIComponent(hed),$('<div class="pcmag-buyitnow-hed-wrapper"><h3 class="pcmag-buyitnow-hed"><span class="pcmag-buyitnow-buyitnow">'+hed+"</span></h3></div>")}function floatifyPrice(str){return"string"==typeof str?(str=str.slice(1).replace(/\,/g,""),parseFloat(str)):str}function lowestPrice(lowPrice){return $("<div class='pcmag-buyitnow-lowest-price'><span class='pcmag-buyitnow-lowest-price-text'>Lowest Price</span><span class='pcmag-buyitnow-lowest-price-value'>"+lowPrice+"</span></div>")}function attachClick(row,offer,callback){row.on("click",function(e){e.preventDefault(),track(offer),callback&&callback(offer),window.open(offer.Url)})}function appendStylesheet(css){var scriptSrc=$(script).attr("src"),path=scriptSrc.substring(0,scriptSrc.lastIndexOf("/")),link=path+"/buyitnow.min.css";css&&(link=decodeURIComponent(css)),$("head").append("<link rel='stylesheet' type='text/css' href='"+link+"'/>")}function img(src,alt){return"<img src='"+src+"' alt='"+alt+"' />"}function row(offer,highlight,displayLogo,displayExtraPriceInfo){var cls=highlight?" class='pcmag-buyitnow-best-price'":"",trackingAttributes=trackingAttributesFor(offer),price=offer.Price;""===price&&(price='<div class="price-too-low"><span>too low to show</span></div>');var vendor=offer.CanonicalVendor?offer.CanonicalVendor:offer.Vendor,logo=displayLogo&&""!==offer.Logo&&null!==offer.Logo?img(offer.Logo,vendor):vendor,extraInfo=displayExtraPriceInfo?freeShipping(offer)+configuration(offer):"",rowMarkup=$("<tr"+cls+" "+trackingAttributes+"><td class='pcmag-buyitnow-logo'>"+logo+"</td><td class='pcmag-buyitnow-price'>"+price+extraInfo+"</td><td class='pcmag-buyitnow-buybutton'><a href='#' "+trackingAttributes+"><span></span></a></td></tr>");return rowMarkup}function shouldDisplayLogo(index,logoParameter){return"all"===logoParameter?!0:"best"===logoParameter?0===index:!1}function init(jquery){var $script,q,css,clickCallback;$=jquery||window.jQuery.noConflict(),"undefined"!=typeof window.__zdcseOriginalJquery&&(window.jQuery=window.$=window.__zdcseOriginalJquery),$script=$(script),q=parseQuerystring($script.attr("src")),css=q.css,clickCallback=getFunctionByName(q.onclick,window),q.co=getCountryCode(),q.module="buyitnow",q.logo=q.logo||"best",q.freeShipping="true"===q.freeShipping,q.lowPrice="true"===q.lowPrice,appendStylesheet(css);var container=$('<div class="pcmag-buyitnow"></div>');getPrices(q).done(function(data){var offer,r,d=data,results=getFirstResult(d),hed="undefined"==typeof q.hed?"Buy It Now":q.hed,table=$("<table cellspacing='0' cellpadding='0' class='pcmag-buyitnow-table'>"),tbody=$("<tbody>"),lowPriceValue=0,rows=[],appendedHtml=[];if(results){for(var i=0;i<results.length;i++)offer=results[i],offer.OpenHtml&&offer.OpenHtml.length>0&&appendedHtml.push(offer.OpenHtml.replace("\\n"," ").replace("\\r"," ").replace("\\t"," ")),""!==offer.Vendor&&(r=row(offer,0===i,shouldDisplayLogo(i,q.logo),q.freeShipping),attachClick(r,offer,clickCallback),tbody.append(r),rows.push(r),(0===lowPriceValue||floatifyPrice(offer.Price)<floatifyPrice(lowPriceValue))&&(lowPriceValue=offer.Price));table.append(tbody),q.lowPrice&&0!==lowPriceValue&&container.append(lowestPrice(lowPriceValue)),results.length>0&&(container.append(header(hed)),container.append(table))}if(appendedHtml.length>0){var appendedContainer=$("<div class='commerce-appended-html'></div>");appendedContainer.html(appendedHtml.join("")),container.append(appendedContainer)}$script.after(container),triggerCallback(q.onload,rows)})}"forEach"in Array.prototype||(Array.prototype.forEach=function(fn,scope){"use strict";var i,len;for(i=0,len=this.length;len>i;++i)i in this&&fn.call(scope,this[i],i,this)}),"indexOf"in Array.prototype||(Array.prototype.indexOf=function(find,i){void 0===i&&(i=0),0>i&&(i+=this.length),0>i&&(i=0);for(var n=this.length;n>i;i++)if(i in this&&this[i]===find)return i;return-1}),console||(window.console={}),console.log||(window.console.log=function(){});for(var script,$,scripts=document.getElementsByTagName("script"),scriptIndex=0,protocol="https"===document.location.protocol?"https://":"http://",cseUrl="cse.adziff.com/CSE/TopPrices",foundit=!1,s=0;s<scripts.length;s++)scripts[s].getAttribute("src")&&scripts[s].getAttribute("src").toLowerCase().indexOf("buyitnow")>-1&&"true"!==scripts[s].getAttribute("data-buyitnow")&&(script=scripts[s],script.setAttribute("data-buyitnow","true"),foundit=!0);if(!foundit)return console.log("BuyItNow is bailing!"),!1;var requiredLibs=[];(!window.jQuery||window.jQuery&&parseFloat(window.jQuery.fn.jquery)<1.9)&&(window.jQuery&&(window.__zdcseOriginalJquery=jQuery),requiredLibs.push("http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js")),window.ZDXI||requiredLibs.push("http://static.ziffdavis.com/js/zdcc/1.0.0/zdcc.js"),requiredLibs.length>0?injectScript({url:requiredLibs,to:document.getElementsByTagName("body")[0],callback:init}):init(window.jQuery)}();